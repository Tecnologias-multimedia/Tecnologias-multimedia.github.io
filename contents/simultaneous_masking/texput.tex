% Emacs, this is -*-latex-*-

\input{../../definitions}
\title{Simultaneous Masking in the Frequency Domain}

% Ante la presencia de suficiente energía en una subbanda, los quantization step sizes (QSS) del resto de subbandas podrían aumentarse porque la subbanda más energética enmascara a las demás. En el dominio wavelet, donde más o menos tenemos una distribución diádica de frecuencias entre subbandas, podemos suponer que si la subbanda h^i es la más energética y E(h^i) es su energía, podemos suponer que las subbandas h^{i+1} y h^{i-1} podrían unar un QSS*2, y que las subbandas h^{i+2} y h^{i-2} un QSS*4, etc. Si l^i es la más energética, entonces la QSS para h^i sería QSS*2, y así sucesivamente.

\maketitle

\section{Frequencial Masking}
The HAS (Human Auditory System) has a finite frequency resolution,
which basically means that weaker audio signal (maskee) becomes
inaudible in the presence of (is masked by) a louder audio (masker),
when they are closed enough~\cite{bosi2003intro}, in frequency (and
obviously in time). When this happens, the
subband~\cite{vetterli1995wavelets} where the maskee signal is placed
can be quantized more severely without perceiving that the
quantization noise in such subband could be increased (see
Figure~\ref{fig:SM}).

\begin{figure}
  \centering
  \png{simultaneous_masking}{600}
  \caption{An example of simultaneous masking generated by a tonal
    sound of 1 kHz. In the vecinity of the tone The threshold of
    hearing has been increased.}
  \label{fig:SM}
\end{figure}

%Sumarizing, simultaneous frequencial masking depends on:
%\begin{enumerate}
%\item The proximity in frequency of the maskee (quiet) and masker
%  (loud) signals.
%\item Their overlap over time.
%\end{enumerate}

%How much quantization noise can be generated without it being audible?
%Psychoacoustics has the answer: 

\section{A dynamic computation of the Quantization Step Sizes}
\label{sec:algo}
\begin{enumerate}
\item Given a decomposition of a chunk ${\mathbf W}=\{{\mathbf w}_s\}$, determine
  the energy $\{E({\mathbf w}_s)\}$ of each subband.
\item Find the subband with the maximum energy:
  \begin{equation}
    {\mathbf w}_m = \underset{{\mathbf w}_i \in {\mathbf W}}{\operatorname{arg\,max}}~E({\mathbf w}_m) := \{{\mathbf w}_* \in {\mathbf W} ~:~ E({\mathbf w}_i) \leq E({\mathbf w}_m) \text{ for all } {\mathbf w}_i \in {\mathbf W} \}.
  \end{equation}
\item Being ${\mathbf \Delta}_m$ the current QSS of the subband
  ${\mathbf w}_m$, compute the set of optimal\footnote{From a
    perceptual perspective.} QSSs as
  \begin{equation}
    {\mathbf \Delta}^* := \{\cdots,3{\mathbf \Delta}_{x-2},2{\mathbf \Delta}_{x-1},{\mathbf \Delta}_x,2{\mathbf \Delta}_{x+1},3{\mathbf \Delta}_{x+2}, \cdots\}.
  \end{equation}
\end{enumerate}

\section{Deliverables}

Implement the algorithm described in Section~\ref{sec:algo} in a
module named \verb|simultaneous_masking.py|. You should extend the
classes defined in \verb|advanced_ToH.py|.

\section{Resources}

\bibliography{maths,data_compression,DWT,audio_coding}

