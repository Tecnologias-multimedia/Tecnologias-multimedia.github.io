<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Tecnolog&#x00C3;&#x014B;as Multimedia - Study Guide - Milestone 4: &#x201C;wiring&#x201D; the ADC with the
DAC, and measuring latencies</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- xhtml,mathml,html --> 
<meta name="src" content="index.tex" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead"><a 
href="https://www.ual.es/estudios/grados/presentacion/plandeestudios/asignatura/4015/40154321?idioma=zh_CN" >Tecnolog&#x00ED;as Multimedia</a> - Study Guide -
Milestone 4: &#x201C;wiring&#x201D; the ADC with the DAC,
and measuring latencies</h2>
 <div class="author" ><a 
href="https://cms.ual.es/UAL/personas/persona.htm?id=515256515553484875" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">&#x00E1;</span><span 
class="ecrm-1200">lez Ruiz</span></a> <span 
class="ecrm-1200">- </span><a 
href="https://cms.ual.es/UAL/universidad/departamentos/informatica/index.htm" ><span 
class="ecrm-1200">Depto Inform</span><span 
class="ecrm-1200">&#x00E1;</span><span 
class="ecrm-1200">tica</span></a> <span 
class="ecrm-1200">- </span><a 
href="https://www.ual.es" ><span 
class="ecrm-1200">UAL</span></a></div><br />
<div class="date" ><span 
class="ecrm-1200">August 30, 2021</span></div>
   </div>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Description</h3>
<!--l. 8--><p class="noindent" >Let&#x2019;s start our understanding of InterCom with a simple program that inputs digital
audio &#x0028;through the <a 
href="https://en.wikipedia.org/wiki/Analog-to-digital_converter" >ADC</a> of your computer&#x0029; and, as soon as possible, outputs the
audio &#x0028;through the <a 
href="https://en.wikipedia.org/wiki/Digital-to-analog_converter" >DAC</a>&#x0029;. We are going to use a minimal &#x201C;wiring&#x201D; program, that
when it is run and we feed back the audio output with the audio input of our
computer, allows us to measure the <a 
href="https://en.wikipedia.org/wiki/Latency_(engineering)" >latency</a> of this system. To handle the
audio hardware we use <a 
href="https://python-sounddevice.readthedocs.io" ><span 
class="ectt-1000">sounddevice</span></a> <span class="cite">&#x005B;<a 
href="#Xsounddevice">1</a>&#x005D;</span>, that is wrapper for the <a 
href="http://www.portaudio.com/" >PortAudio</a>
library.
</p><!--l. 23--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>What you have to do?</h3>
<!--l. 25--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2002x1">Refresh some &#x0028;probably high-school&#x0029; ideas about <a 
href="https://vicente-gonzalez-ruiz.github.io/the_sound/" >the sound</a>, <a 
href="https://vicente-gonzalez-ruiz.github.io/human_auditory_system/" >the human
     auditory system</a>, and <a 
href="https://vicente-gonzalez-ruiz.github.io/human_sound_perception/" >the human sound perception</a>.
     </li>
     <li 
  class="enumerate" id="x1-2004x2">Download the Python <a 
href="https://docs.python.org/3/tutorial/modules.html" >module</a> <a 
href="https://raw.githubusercontent.com/Tecnologias-multimedia/intercom/master/test/sounddevice/wire3.py" >wire3.py</a> with:
     <!--l. 41-->
                                                                  

                                                                  
     <div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-2005r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sudo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">apt</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">curl</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2006r2"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">curl</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">https</span><span 
class="ectt-1000">://</span><span 
class="ectt-1000">raw</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">githubusercontent</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">com</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">Tecnologias</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">multimedia</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">intercom</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">master</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">sounddevice</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">wire3</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">wire3</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span>
     
     </div>
     <!--l. 46--><p class="noindent" >This module implements the algorithm:
</p>
     <!--l. 48-->
     <div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-2007r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">while</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">True</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2008r2"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sound_card</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">&#x0028;</span><span 
class="ectt-1000">chunk_size</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1024&#x0029;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">&#x0028;1&#x0029;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2009r3"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sound_card</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">&#x0028;</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">&#x0029;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">&#x0028;2&#x0029;</span>
     
     </div>
<a 
 id="x1-2010r1"></a>
     <!--l. 54--><p class="noindent" ><!--l. 54--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mstyle mathvariant="monospace"><mi 
>C</mi><mi 
>H</mi><mi 
>U</mi><mi 
>N</mi><mi 
>K</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>S</mi><mi 
>I</mi><mi 
>Z</mi><mi 
>E</mi></mstyle> <mo 
class="MathClass-rel">&#x2190;</mo> <mn>1</mn><mn>0</mn><mn>2</mn><mn>4</mn>                                                                                                 </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"><mstyle 
class="mbox"><mtext  >while&#x00A0;</mtext></mstyle><mstyle 
class="mbox"><mtext  >&#x00A0;true&#x00A0;</mtext></mstyle> <mrow><mo fence="true" form="prefix"> {</mo><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mstyle mathvariant="monospace"><mi 
>c</mi><mi 
>h</mi><mi 
>u</mi><mi 
>n</mi><mi 
>k</mi></mstyle> <mo 
class="MathClass-rel">&#x2190;</mo><mstyle mathvariant="monospace"><mi 
>s</mi><mi 
>t</mi><mi 
>r</mi><mi 
>e</mi><mi 
>a</mi><mi 
>m</mi></mstyle><mo 
class="MathClass-punc">.</mo><mstyle mathvariant="monospace"><mi 
>r</mi><mi 
>e</mi><mi 
>a</mi><mi 
>d</mi></mstyle><mo 
class="MathClass-open">&#x0028;</mo><mstyle mathvariant="monospace"><mi 
>C</mi><mi 
>H</mi><mi 
>U</mi><mi 
>N</mi><mi 
>K</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>S</mi><mi 
>I</mi><mi 
>Z</mi><mi 
>E</mi></mstyle><mo 
class="MathClass-close">&#x0029;</mo></mtd><mtd 
class="array"  columnalign="right"> <mstyle 
   id="x1-2011r1"  class="label" ></mstyle><!--endlabel--><mspace width="72.26999pt"/>                      <mstyle 
class="mbox"><mtext  >&#x0028;1&#x0029;</mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"><mstyle mathvariant="monospace"><mi 
>s</mi><mi 
>t</mi><mi 
>r</mi><mi 
>e</mi><mi 
>a</mi><mi 
>m</mi></mstyle><mo 
class="MathClass-punc">.</mo><mstyle mathvariant="monospace"><mi 
>w</mi><mi 
>r</mi><mi 
>i</mi><mi 
>t</mi><mi 
>e</mi></mstyle><mo 
class="MathClass-open">&#x0028;</mo><mstyle mathvariant="monospace"><mi 
>c</mi><mi 
>h</mi><mi 
>u</mi><mi 
>n</mi><mi 
>k</mi></mstyle><mo 
class="MathClass-close">&#x0029;</mo>                   </mtd><mtd 
class="array"  columnalign="right"><mstyle 
   id="x1-2012r2"  class="label" ></mstyle><!--endlabel--><mspace width="74.438pt"/>                      <mstyle 
class="mbox"><mtext  >&#x0028;2&#x0029;</mtext></mstyle></mtd></mtr><!--@{}lr@{}--></mtable>                            </mrow><mo fence="true" form="postfix"></mo></mrow>  </mtd></mtr>
<!--@{}lr@{}--></mtable>                                                                                                                              </mrow><mo fence="true" form="postfix"></mo></mrow></math>
     </p><!--l. 65--><p class="noindent" >where <span 
class="ectt-1000">&#x0028;</span>1&#x0029; captures <!--l. 65--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>1</mi><mi 
>0</mi><mi 
>2</mi><mi 
>4</mi></mstyle></math>
     frames from the sound card, and &#x0028;2&#x0029; plays the chunk of frames
     <!--l. 67--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>c</mi><mi 
>h</mi><mi 
>u</mi><mi 
>n</mi><mi 
>k</mi></mstyle></math>.
     In <span 
class="ectt-1000">sounddevice </span>a frame is a collection of one or more samples &#x0028;typically, a
     frame is a single sample if the number of channels is 1, or two samples if the
     number of channels is 2&#x0029;.
     </p></li>
     <li 
  class="enumerate" id="x1-2014x3">If you want to run this module right now, check &#xFB01;rst that the output volumen
     of your speakers is not too high, otherwise you could &#x201C;couple&#x201D; the speaker and
     the mic&#x0028;rophone&#x0029; of your computer, producing a loud and annoying sound. In
     order to mitigate this e&#xFB00;ect, you can also control the record gain of your mic &#x0028;if
     the gain is 0, no feedback between the speaker and the mic will be possible&#x0029;. In
     Xubuntu, these controls are available by clicking in the speaker icon
     &#x0028;situated in the top right corner of your screen&#x0029; of the Xfce window
     manager.
     </li>
     <li 
  class="enumerate" id="x1-2016x4">OK, run it &#x0028;remember to activate &#xFB01;rst the virtual environment <span 
class="ectt-1000">tm </span>before using
     Python&#x0029;, with:
     <!--l. 85-->
     <div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-2017r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pip</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sounddevice</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2018r2"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">python</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">wire3</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span>
     
     </div>
     </li>
     <li 
  class="enumerate" id="x1-2020x5">Now, lets compute, experimentally, the <span 
class="ectt-1000">wire3.py </span>latency.
     <!--l. 103--><p class="noindent" >
                                                                  

                                                                  
         </p><ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-2022x1">First, we need the tools <a 
href="http://sox.sourceforge.net/" >SoX</a>, <a 
href="https://www.audacityteam.org/" >Audacity</a> and <a 
href="https://raw.githubusercontent.com/Tecnologias-multimedia/intercom/master/test/sounddevice/wire3.py" >wire3.py</a>:
         <!--l. 107-->
         <div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-2023r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sudo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">apt</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sox</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2024r2"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sudo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">apt</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">audacity</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2025r3"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sudo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">apt</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">curl</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2026r4"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">curl</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">https</span><span 
class="ectt-1000">://</span><span 
class="ectt-1000">raw</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">githubusercontent</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">com</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">Tecnologias</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">multimedia</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">intercom</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">master</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">sounddevice</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">plot_input</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">plot_input</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span>
         
         </div>
         </li>
         <li 
  class="enumerate" id="x1-2028x2">Run:
         <!--l. 116-->
         <div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-2029r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pip</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">matplotlib</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2030r2"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">python</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">plot_input</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span>
         
         </div>
         <!--l. 121--><p class="noindent" >and check that the gain of the mic does not produce <a 
href="https://en.wikipedia.org/wiki/Clipping_(audio)" >clipping</a> during the
         sound recording.
         </p></li>
         <li 
  class="enumerate" id="x1-2032x3"><a 
 id="x1-20313"></a> In a terminal, run:
         <!--l. 127-->
         <div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-2033r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">python</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">wire3</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">py</span>
         
         </div>
         <!--l. 131--><p class="noindent" >while you control the output volume of the speakers to produce a decaying
         coupling e&#xFB00;ect between both devices &#x0028;the speaker&#x0028;s&#x0029; and the mic&#x0029;. If your
         desktop has not these <a 
href="https://en.wikipedia.org/wiki/Transducer" >transducers</a>, we can use a <a 
href="https://www.google.com/search?q=male+to+male+audio+jack+cable&client=firefox-b-d&sxsrf=ALeKk00GZUDGqiOfc0D8xkA_MIYgCuZmSA:1600270049146&source=lnms&tbm=isch&sa=X&ved=2ahUKEwjdvsu-_u3rAhXl0eAKHS90DUoQ_AUoAXoECA0QAw&biw=4288&bih=972" >male-to-male jack
         audio cable</a> and connect the input and the output of your sound
         card.
         </p></li>
         <li 
  class="enumerate" id="x1-2035x4">In a di&#xFB00;erent terminal &#x0028;keep <span 
class="ectt-1000">python wire3.py </span>running&#x0029;, run:
         <!--l. 143-->
         <div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-2036r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sox</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">t</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">alsa</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">default</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">wav</span>
         
         </div>
         <!--l. 147--><p class="noindent" >to save the ADC&#x2019;s output to a &#xFB01;le.
         </p></li>
         <li 
  class="enumerate" id="x1-2038x5">While <span 
class="ectt-1000">sox </span>is recording, produce some short sound &#x0028;for example,
         hit your laptop or your micro with one or your nails&#x0029;. Do this
         at least a couple of times more, to be sure that you record the
         sound and the feedback of such sound. It&#x2019;s important the sound
         to be short &#x0028;a few miliseconds&#x0029; in order to recognize it and it&#x2019;s
         replicas.
                                                                  

                                                                  
         </li>
         <li 
  class="enumerate" id="x1-2040x6">Stop <span 
class="ectt-1000">sox </span>by pressing the CTRL and C keys &#x0028;CTRL+C&#x0029; at the same time.
         This kills <span 
class="ectt-1000">sox</span>.
         </li>
         <li 
  class="enumerate" id="x1-2042x7">Stop <span 
class="ectt-1000">python wire3.pt </span>with CTRL+C.
         </li>
         <li 
  class="enumerate" id="x1-2044x8">Load the sound &#xFB01;le into Audacity:
         <!--l. 163-->
         <div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-2045r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">audacity</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">wav</span>
         
         </div>
         </li>
         <li 
  class="enumerate" id="x1-2047x9">Localize the &#xFB01;rst one of your nail-hitting-the-mic sounds in the <a 
href="https://manual.audacityteam.org/man/audio_tracks.html" >audio
         track</a>.
         </li>
         <li 
  class="enumerate" id="x1-2049x10">Select the region with your sound and a replica using our mouse.
         </li>
         <li 
  class="enumerate" id="x1-2051x11">Use the <a 
href="https://manual.audacityteam.org/man/edit_toolbar.html#zoom_to_selection" >zoom to selection buttom</a> to zoom-in the selected area.
         </li>
         <li 
  class="enumerate" id="x1-2053x12">Measure the time between the ocurrence of the sound and it&#x2019;s &#xFB01;rst
         replica. This time is the real latency of your computer runing
         <span 
class="ectt-1000">wire3.py</span>.
         </li>
         <li 
  class="enumerate" id="x1-2055x13">Modify the constant <!--l. 183--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>C</mi><mi 
>H</mi><mi 
>U</mi><mi 
>N</mi><mi 
>K</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>S</mi><mi 
>I</mi><mi 
>Z</mi><mi 
>E</mi></mstyle></math>
         and repeat this process, starting at the Step <a 
href="#x1-20313">5c<!--tex4ht:ref: start_point --></a>. Create an ASCII &#xFB01;le
         &#x0028;<span 
class="ectt-1000">latency_vs_chunk_size.txt</span>&#x0029; with the content &#x0028;use tabulators to space
         the columns&#x0029;:
                                                                  

                                                                  
         <pre class="verbatim" id="verbatim-1">
         #&#x00A0;CHUNK_SIZE&#x00A0;&#x00A0;&#x00A0;&#x00A0;real
         32&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         64&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         128&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         256&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         512&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         1024&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         2048&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         4096&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
         8192&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...
</pre>
         <!--l. 198--><p class="nopar" >
</p>
         </li></ol>
     </li>
     <li 
  class="enumerate" id="x1-2057x6">At this point, we know the real latency of <span 
class="ectt-1000">wire3.py </span>as a function of
     <!--l. 203--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>C</mi><mi 
>H</mi><mi 
>U</mi><mi 
>N</mi><mi 
>K</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>S</mi><mi 
>I</mi><mi 
>Z</mi><mi 
>E</mi></mstyle></math>.
     Plot the &#xFB01;le <span 
class="ectt-1000">latency_vs_chunk_size.txt </span>with:
     <!--l. 206-->
     <div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-2058r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sudo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">apt</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">install</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">gnuplot</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2059r2"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">terminal</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pdf</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">output</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">latency_vs_chunk_size</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">pdf</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xlabel</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">CHUNK</span><span 
class="ectt-1000">&#x005C;</span><span 
class="ectt-1000">_SIZE</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x0028;</span><span 
class="ectt-1000">frames</span><span 
class="ectt-1000">&#x0029;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ylabel</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">Latency</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x0028;</span><span 
class="ectt-1000">seconds</span><span 
class="ectt-1000">&#x0029;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">plot</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">latency_vs_chunk_size</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">txt</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">title</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;&#x0027;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">linespoints</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">gnuplot</span>
     
     </div>
     </li>
     <li 
  class="enumerate" id="x1-2061x7">Let&#x2019;s compute now the bu&#xFB00;ering latency of a chunk &#x0028;the chunk-time&#x0029;. If
     <!--l. 212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>s</mi><mi 
>a</mi><mi 
>m</mi><mi 
>p</mi><mi 
>l</mi><mi 
>i</mi><mi 
>n</mi><mi 
>g</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>r</mi><mi 
>a</mi><mi 
>t</mi><mi 
>e</mi></mstyle></math>
     is the number of frames per second, it holds that:
     <table class="equation"><tr><td> <a 
 id="x1-2062r1"></a>
     <!--l. 215--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                 <mstyle mathvariant="monospace"><mi 
>b</mi><mi 
>u</mi><mi 
>f</mi><mi 
>f</mi><mi 
>e</mi><mi 
>r</mi><mi 
>i</mi><mi 
>n</mi><mi 
>g</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>l</mi><mi 
>a</mi><mi 
>t</mi><mi 
>e</mi><mi 
>n</mi><mi 
>c</mi><mi 
>y</mi></mstyle> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi 
>C</mi><mi 
>H</mi><mi 
>U</mi><mi 
>N</mi><mi 
>K</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>S</mi><mi 
>I</mi><mi 
>Z</mi><mi 
>E</mi></mstyle><mo 
class="MathClass-bin">&#x2215;</mo><mstyle mathvariant="monospace"><mi 
>s</mi><mi 
>a</mi><mi 
>m</mi><mi 
>p</mi><mi 
>l</mi><mi 
>i</mi><mi 
>n</mi><mi 
>g</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>r</mi><mi 
>a</mi><mi 
>t</mi><mi 
>e</mi></mstyle>
</math></td><td class="eq-no">&#x0028;1&#x0029;</td></tr></table>
                                                                  

                                                                  
     <!--l. 219--><p class="noindent" >Add these calculations to <span 
class="ectt-1000">latency_vs_chunk_size.txt </span>using a third column
     &#x0028;remember to use TABs&#x0029;.
                                                                  

                                                                  
</p>
     <pre class="verbatim" id="verbatim-2">
     #&#x00A0;CHUNK_SIZE&#x00A0;&#x00A0;&#x00A0;&#x00A0;real&#x00A0;&#x00A0;&#x00A0;&#x00A0;minimal
     :&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:
</pre>
     <!--l. 224--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-2064x8">Plot both latencies:
     <!--l. 228-->
     <div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-2065r1"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">terminal</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pdf</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">output</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">latency_vs_chunk_size</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">pdf</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xlabel</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">CHUNK</span><span 
class="ectt-1000">&#x005C;</span><span 
class="ectt-1000">_SIZE</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x0028;</span><span 
class="ectt-1000">frames</span><span 
class="ectt-1000">&#x0029;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ylabel</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">Latency</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x0028;</span><span 
class="ectt-1000">seconds</span><span 
class="ectt-1000">&#x0029;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">key</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">left</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">plot</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">latency_vs_chunk_size</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">txt</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">using</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1:2</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">title</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">Real</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">linespoints</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">latency_vs_chunk_size</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">txt</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">using</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1:3</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">title</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">Minimal</span><span 
class="tctt-1000">&#x0027;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">linespoints</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">gnuplot</span>
     
     </div>
     </li>
     <li 
  class="enumerate" id="x1-2067x9">Which seems to be the minimal practical latency &#x0028;the latency obtained when
     <!--l. 233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>C</mi><mi 
>H</mi><mi 
>U</mi><mi 
>N</mi><mi 
>K</mi><mstyle 
class="text"><mtext  >_</mtext></mstyle><mi 
>S</mi><mi 
>I</mi><mi 
>Z</mi><mi 
>E</mi></mstyle> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>&#x0029;
     in your computer? Justify your answers. <a 
 id="x1-20669"></a>
     </li></ol>
<!--l. 238--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-30003"></a>Timming</h3>
<!--l. 240--><p class="noindent" >You should reach this milestone at most in one week.
</p><!--l. 242--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-40004"></a>Deliverables</h3>
<!--l. 244--><p class="noindent" >Answer the question enunciated in the Step &#x00A0;<a 
href="#x1-20669">9<!--tex4ht:ref: question --></a>.
</p><!--l. 246--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-50005"></a>Resources</h3>
                                                                  

                                                                  
   <div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 &#x005B;1&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsounddevice"></a>M.&#x00A0;Walker. <a 
href="https://python-sounddevice.readthedocs.io/en/latest/" >python-sounddevice</a>.
</p>
   </div>
<a 
 id="Q1-1-6"></a>
    
</body></html> 

                                                                  


