\title{\href{https://www.ual.es/estudios/grados/presentacion/plandeestudios/asignatura/4015/40154321?idioma=zh_CN}{Tecnologías Multimedia} - Study Guide - Milestone 12: Intra-channel Decorrelation

\maketitle

\section{Description}

Transform Coding (TC) is a basic signal decorrelating tool, used in
most multimedia (audio, image and vídeo) compression systems. The main
reasons for this are: (1) a good \href{}{coding
  gain}~\cite{sayood2017introduction}, (2) a reasonable
\href{}{computational complexity} (usually equal or smaller than
$O(N\log_2N)$, (3) \href{}{in-place} computation, and (4) that are
able to provide \href{}{multiresolution} representations. The
Figure~\ref{fig:transform_coding} shows the stages that are tipycally
involved in a transform-based signal compression system.

\begin{figure}
  \begin{center}
\begin{verbatim}
   s   +---+   w    +---+   k    +---+    c
 ----->| T |------->| Q |------->| E |-----------+
  (s)  +---+  (s)   +---+  (~s)  +---+   (~s)    |
samples   coefficients   indexes      code-words ~
                                                 :
                                                 ~
   ~s  +---+    w   +---+   k    +---+           |
 <-----| t |<-------| q |<-------| D |<----------+
  (~s) +---+  (~s)  +---+  (~s)  +---+
approx.    quantized     indexes
samples   coefficients
\end{verbatim}                
  \end{center}
  \caption{Common data-flow used un Transform Coding. $s$ represents
    the signal to compress, $\tilde{s}$ the lossy version of the
    reconstructed signal, $T$ the (forward) transform (which takes blocks of
    samples) producing blocks of coefficients $w$, $Q$ the scalar
    quantization stage (which takes single coefficients) producing
    quantization indexes $k$, $E$ the entropy encoder (which in our
    case (DEFLATE) works with blocks of coefficients) producing
    code-words $c$, $D$ the entropy decoder, $q$ the decuantization
    stage, and $t$ the inverse (or backward) transform. PCM stands for Puse Code
    Modulation and DEFLATE is the technique used to find a compact
    representation of the quantized coefficients.}
  \label{fig:transform_coding}
\end{figure}

There exist docens of suitable transform used in TC. They are
characterized by the
\href{https://en.wikipedia.org/wiki/Orthogonality}{orthogonality}
property, which basically means that the output coefficients are going
to be decorrelated because the functions (or vectors, depending on the
terminology) that describe the transform are
\href{https://en.wikipedia.org/wiki/Orthogonal_functions}{orthogonal}
and therefore, form a
\href{https://en.wikipedia.org/wiki/Basis_(linear_algebra)}{basis
  (set)} with which is possible to describe any signal in terms
(usually as a linear combination) of the (basis) functions of such
basis, i.e., are able to describe any signal in the vector space
spanned by the basis, using an unique description (set of
coefficients)~\cite{}.

Wavelets and Wavelet Transforms
% https://cnx.org/contents/EQurkhlI@6.9:9Qg8uP5e@5/Introduction-to-Wavelets
% https://cnx.org/exports/110bab92-1948-4958-b1c7-8fc0926c392c@6.9.pdf/wavelets-and-wavelet-transforms-6.9.pdf

Other major family of transform used in TC forms bi-orthogonal basis
(sets). In this case,

In this milestone we will use an orghogonal wavelet transform. This
makes that the quantization of the coefficients can be uniform, i.e.,
we can use the same quantization step for all the coefficients.

In the transform described in the previous milestone, the concept of subband is degradated because we have only one coefficient per subband.

The coefficient $w[0]$ is called the DC (Direct Current) coefficient, and the rest of coefficients are called AC (Alternating Current) coefficients.

\href{https://en.wikipedia.org/wiki/Correlation_and_dependence}{Correlation}
is a term used in statistics which refer to the interdependency
between two \href{https://en.wikipedia.org/wiki/Random_variable}{random
  variables}. It can be measured by the
\href{https://www.mathsisfun.com/data/correlation.html}{correlation
  coefficient}~\cite{thinkstats}.

In the case of InterCom, the random variables are the two channels
(left $L$ and right $R$) of the
\href{https://en.wikipedia.org/wiki/Stereophonic_sound}{stereo
  \href{https://en.wikipedia.org/wiki/Pulse-code_modulation}{PCM}
  signal}~\cite{bosi2003intro}. In most cases, both channels are going
to be \href{https://en.wikipedia.org/wiki/Binaural_recording}{highly
  correlated} (especially if the microphone is mono), which means that
we can represent one of them (for example, the $R$ channel) with
respect to the other (the $L$ channel). From a mathematical point of
view, this process can be seen as a
\href{https://en.wikipedia.org/wiki/Decorrelation}{decorrelation}
process. From a physical perspective, decorrelating implies energy
accumulation in a few coefficients~\cite{sayood2017introduction}.

To perform this inter-channel decorrelation, we can use an
\href{https://en.wikipedia.org/wiki/Orthogonal_transformation}{orthogonal}\footnote{Orthogonality
  of the transform is a important property because the correlation
  between the coefficients (the output of the transform) is 0.}
transform, that in the case of decorrelating a stereo signal is
\begin{equation}
  y = Kx = \frac{1}{2}\begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix}x,
\end{equation}
where $x$ represents a frame (a tuple of L and R samples, $x[0]$ and
$x[1]$), $K$ is the $2\times 2$ KLT
\href{http://fourier.eng.hmc.edu/e161/lectures/klt/node3.html}{(Karhunen-Lo\`eve
  Transform)} matrix multiplied by $1/\sqrt{2}$ (which is closely
related to the \href{http://wavelets.pybytes.com/wavelet/haar/}{Haar
  transform}~\cite{vetterli1995wavelets}), and $y$ represents the
transform coefficients (in our case, a couple of coefficients $y[0]$
with the \href{https://en.wikipedia.org/wiki/Arithmetic_mean}{mean}
and $y[1]$ with the difference of the samples). Notice that this
transform is not
\href{https://en.wikipedia.org/wiki/Orthonormal_basis}{orthonormal}
(energy preserving in the transform domain) because
\begin{equation}
  \sum y[i]^2 = \frac{1}{\sqrt{2}}\sum x[i]^2,
\end{equation}
although both subbands $y[0]$ and $y[1]$ have the same gain
($\frac{1}{\sqrt{2}}$, and therefore the same ``importance'' for a
future
\href{https://en.wikipedia.org/wiki/Quantization_(signal_processing)}{quantization}
of $y$). The described transform is similar to the so called
\href{https://en.wikipedia.org/wiki/Joint_encoding#M/S_stereo_coding}{M/S
  stereo coding}, but in our case, the división by 2 is carried on
the forward transform, instead of the backward (inverse) transform.

This transform can be implemented
\href{https://en.wikipedia.org/wiki/In-place_algorithm}{\emph{in-place}}
using the following algorithm:

\begin{pseudocode}{Inter-channel\_decorrelation}{~}
  \PROCEDURE{analyze}{\text{frame}}
  \BEGIN
    \text{frame}[0] -= \text{frame}[1] \\
    \text{frame}[1] += (\text{frame}[0] / 2) \\
    \text{frame}[0] /= 2
  \END
  \ENDPROCEDURE
  \PROCEDURE{synthesize}{\text{frame}}
  \BEGIN
    \text{frame}[0] *= 2 \\
    \text{frame}[1] -= (\text{frame}[0] / 2) \\
    \text{frame}[0] += \text{frame}[1]
  \END
  \ENDPROCEDURE
\end{pseudocode}

where $\text{a}~\mathtt{OPER}= \text{b}$ is a shorter representation of the operation
$\text{a} = \text{a}~\mathtt{OPER}~\text{b}$. Notice that this type of in-place computations
are commonly used in the implementation of DWTs
(\href{https://en.wikipedia.org/wiki/Discrete_wavelet_transform}{Dicrete
  Wavelet Transform}s) using
\href{https://cm-bell-labs.github.io/who/wim/papers/athome/athome.pdf}{the
  Lifting Scheme}~\cite{2006.sweldens}.

\section{What you have to do?}

\begin{enumerate}
\item In a module named stereo.py, inherit the class
  Quantization and create a class named Stereo\_decorrelation.
\item Override the methods pack() and unpack(). In
  pack() perform the procedure analyze() previously
  described, and in unpack() the
  synthesize(). These procedures should be applied to
  all the frames of a chunk using \href{https://www.oreilly.com/library/view/python-for-data/9781449323592/ch04.html}{vectorized
    operations}.
\item Has been the
  \href{https://en.wikipedia.org/wiki/Data_compression_ratio}{compression
    ratio} improved (on
  \href{https://en.wikipedia.org/wiki/Average}{average})? How much?
\end{enumerate}

\section{Timming}

You should reach this milestone at most one week.

\section{Deliverables}

The module stereo.py. Store it at the
\href{https://github.com/Tecnologias-multimedia/intercom}{root
  directory} of your InterCom's repo.

\section{Resources}

\bibliography{maths,data-compression,DWT,audio-coding}
